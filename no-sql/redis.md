# redis 学习笔记

## 数据结构
### String 类型
key 的设计原则
{id:1, name:"xx", age:12}
不常修改的 : 序列化方式 xml json protobuf
常用修改的 : entity:{id}:name  entity:{id}:age

分布式锁
乐观锁/悲观锁

访问 计数器

分布式全局序列 获取自增序列(严格要求连续性的/ 批量拿一段减少减少Redis链接操作)
redis/雪花算法/uuid

### Hash 类型
key field1 value1 field2 value2
键的设计 

对比String的意义 
减少内存/cpu消耗, 避免键值冲突, 信息集合在以前方便管理

过期功能不适用Hash键上

不适用场景: 数据量分布时(分片时), 二进制操作, 过期功能只能在key上

### List 类型
底层实现: 单向链表

实现阻塞的消息队列

实现消息推送(按时间倒叙查看, 性能高, 分页取出)

### Set 结构
无序, 不重复唯一的
题库选题, 抽奖, 随机抽选(抽出后排除/保留)SPOP

实现点赞/签到/like功能, 选择/取消选择

实现标签Tag
交集/并集/差集计算 (可能人数的人, 共同关注的人, 我关注的人哪些也关注他)

优化条件查询

金融对账(取两次差集)

### Zset 结构
带分值的 Set, 分值有业务含义
分值相同时 按 元素的 ascii码 (字典序排列)

排行榜实现/ 日榜 / 周榜 / 月榜 / 年榜

自动补全功能实现

## 分片
预分配hash槽方案 取模 hash 一致性hash 权重